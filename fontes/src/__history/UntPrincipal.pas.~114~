unit UntPrincipal;

interface

uses
  UntTelaInicial,
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,  Vcl.Controls, Vcl.Forms, Vcl.Dialogs,
  Vcl.ComCtrls, Vcl.ExtCtrls,
  AdvMenus,
  W7Classes, W7ListViewItems, W7Buttons, W7Bars, W7Panels,
  Vcl.ImgList, Vcl.ActnList;

type
  TFrmPrincipal = class(TForm)
    W7ToolBar1: TW7ToolBar;
    W7Panel1: TW7Panel;
    W7TaskItem1: TW7TaskItem;
    W7PnlAberturaTelas: TW7Panel;
    W7ToolButton2: TW7ToolButton;
    W7ToolButton3: TW7ToolButton;
    W7InformationBar1: TW7InformationBar;
    ImageList1: TImageList;
    W7TaskItem2: TW7TaskItem;
    ActionList1: TActionList;
    ActTelaBase: TAction;
    ActTelaCadastroClientes: TAction;
    W7ToolButton1: TW7ToolButton;
    W7ToolButton4: TW7ToolButton;
    W7ToolButton5: TW7ToolButton;
    W7ToolButton6: TW7ToolButton;
    ActTelaAgendaHorario: TAction;
    Timer1: TTimer;
    procedure FormCreate(Sender: TObject);
    procedure ActTelaBaseExecute(Sender: TObject);
    procedure ActTelaCadastroClientesExecute(Sender: TObject);
    procedure ActTelaAgendaHorarioExecute(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure FormActivate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrmPrincipal: TFrmPrincipal;

implementation

{$R *.dfm}

uses
  UntTelaBase01,
  UntTelaCadastroClientes,
  UntTelaAgendaHorario,
  UntTelaLogin;



procedure TFrmPrincipal.ActTelaAgendaHorarioExecute(Sender: TObject);
begin
  TFrmTelaAgandaHorario.AbirTelaAgandaHorario;
end;



procedure TFrmPrincipal.ActTelaBaseExecute(Sender: TObject);
begin
  TFrmTelaBase01.AbrirTela
end;



procedure TFrmPrincipal.ActTelaCadastroClientesExecute(Sender: TObject);
begin
   TFrmTelaCadastroClientes.AbirTelaCadastroClientes;
end;



procedure TFrmPrincipal.FormActivate(Sender: TObject);
begin
  Timer1.Enabled:= True;

end;

procedure TFrmPrincipal.FormCreate(Sender: TObject);
begin
  // Essa deve ser a primeira chamada da função FormCreate
  TFrmTelaInicial.TelaInical;
  TFrmTelaInicial.AtualizarProgresso( 'Iniciando módulo principal', 05, 20);



  TFrmTelaInicial.AtualizarProgresso( 'Conectando no DB', 20, 20);


  TFrmTelaInicial.AtualizarProgresso( 'Carregando módulos', 40, 20);


  TFrmTelaInicial.AtualizarProgresso( 'Verificando agendamento on-line', 80, 20 );


  // Essa deve ser a última chamada da função FormCreate
  TFrmTelaInicial.AtualizarProgresso( 'Iniciando sistema', 100, 20 );
  TFrmTelaInicial.TelaInical;
end;



procedure TFrmPrincipal.Timer1Timer(Sender: TObject);
begin
  Timer1.Enabled:= False;

  TFrmTelaLogin.AbreTelaLogin;

  Sistema.DimencoesAberturaTela.DistanciaEsquerda:=
    ( Screen.Width - W7PnlAberturaTelas.Width );

  Sistema.DimencoesAberturaTela.LarguraPadrao:=
    W7PnlAberturaTelas.Width;

  Sistema.DimencoesAberturaTela.AlturaPadrao:=
    W7PnlAberturaTelas.Height;

  Sistema.DimencoesAberturaTela.AlturaConteiner:=
    W7PnlAberturaTelas.Top + (Screen.Height - Self.Height);
end;


end.
