/*
Descrição:
  Tabela utilizada para gravar os dados do agendamento on line

Histórico de alterações:
  v1.00  - 10/06/2012 
    - Criação da tabela
    - Incluído a chave primária id_uf_pk, os indices cd_uf_uq e ds_uf_uq e a chave estrangeira
    cd_usuario_fk.    
*/       
    	
create table AGENDAMENTOONLINE (
   ID_AGENDAMENTOONLINE 	integer not null 
    
  ,FL_AGENDAMENTOONLINE 	varchar(  1)
  ,TX_AGENDAMENTOONLINEEMAIL  varchar( 80) 
  ,SN_AGENDAMENTOONLINESENHA  varchar( 10)
  
  ,DT_CADASTRO   	timestamp not null
  ,DT_MANUTENCAO 	timestamp not null
  ,DT_EXCLUSAO   	timestamp default null
  
  ,CD_USUARIO    	integer not null  
  
  ,constraint ID_AGENDAMENTOONLINE_PK primary key (ID_AGENDAMENTOONLINE)  
  
  ,constraint TX_AGENDAONLINEEMAIL_UQ unique 	 (TX_AGENDAMENTOONLINEEMAIL)
  ,constraint SN_AGENDAONLINESENHA_UQ unique 	 (SN_AGENDAMENTOONLINESENHA)
  
  ,constraint CD_USUARIO_AGENTONLINE_FK foreign key (CD_USUARIO) references USUARIOS(ID_USUARIO)
    on delete no action on update cascade  
);



create generator ID_AGENTONLINE_AGENTONLINE_GN ;
set generator ID_AGENTONLINE_AGENTONLINE_GN to 0;



create or alter trigger ID_AGENTONLINE_AGENTONLINE_TG for AGENDAMENTOONLINE
  active before insert 
  position 0
as
begin

  new.ID_AGENDAMENTOONLINE = gen_id( ID_AGENTONLINE_AGENTONLINE_GN ,1 ); 

end;